webpackJsonp([8],{RGQ7:function(t,e){},g0fI:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("gRE1"),r=s.n(a),i=s("Xxa5"),n=s.n(i),o=s("exGp"),c=s.n(o),l=s("XLwt"),u=s("Dd8w"),m=s.n(u),h=s("vLgD");function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(h.a)({url:t?"/api/servers/"+t+"/test":"/api/servers/test",method:"post",data:e,timeout:45e3})}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1h";return Object(h.a)({url:"/api/servers/"+t+"/metrics",method:"get",params:{timeRange:e}})}var d={name:"ServerConfigDialog",props:{visible:{type:Boolean,default:!1},server:{type:Object,default:null}},data:function(){var t=this;return{dialogVisible:!1,saving:!1,deleting:!1,testing:!1,testResult:null,formData:{id:null,name:"",host:"",port:22,auth_type:"password",username:"root",password:"",private_key_path:"",key_password:"",monitor_interval:30,description:"",enabled:!0},formRules:{name:[{required:!0,message:"请输入服务器名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],host:[{required:!0,message:"请输入主机地址",trigger:"blur"},{pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$|^[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?)*$/,message:"请输入有效的IP地址或域名",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"},{type:"number",min:1,max:65535,message:"端口号范围 1-65535",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:function(e,s,a){"password"!==t.formData.auth_type||s?a():a(new Error("请输入密码"))},trigger:"blur"}],private_key_path:[{validator:function(e,s,a){"key"!==t.formData.auth_type||s?a():a(new Error("请输入私钥文件路径"))},trigger:"blur"}]}}},computed:{isEdit:function(){return this.server&&this.server.id}},watch:{visible:function(t){this.dialogVisible=t,t&&(this.initForm(),this.testResult=null)},dialogVisible:function(t){this.$emit("update:visible",t)}},methods:{initForm:function(){var t=this;this.server?this.formData=m()({},this.formData,this.server):this.formData={id:null,name:"",host:"",port:22,auth_type:"password",username:"root",password:"",private_key_path:"",key_password:"",monitor_interval:30,description:"",enabled:!0},this.$nextTick(function(){t.$refs.serverForm&&t.$refs.serverForm.clearValidate()})},testConnection:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.serverForm.validateField(["name","host","port","username"]);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),t.$message.warning("请先填写完整的连接信息"),e.abrupt("return");case 9:return t.testing=!0,t.testResult=null,e.prev=11,e.next=14,v(null,t.formData);case 14:s=e.sent,t.testResult={success:s.success,message:s.success?"连接成功！":s.error},s.success?t.$message.success("服务器连接测试成功"):t.$message.error("连接失败: "+s.error),e.next=23;break;case 19:e.prev=19,e.t1=e.catch(11),t.testResult={success:!1,message:"连接测试失败: "+e.t1.message},t.$message.error("连接测试失败: "+e.t1.message);case 23:return e.prev=23,t.testing=!1,e.finish(23);case 26:case"end":return e.stop()}},e,t,[[0,5],[11,19,23,26]])}))()},handleSave:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.serverForm.validate();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return");case 8:return t.saving=!0,e.prev=9,e.next=12,a=t.formData,Object(h.a)({url:a.id?"/api/servers/"+a.id:"/api/servers",method:a.id?"put":"post",data:a});case 12:(s=e.sent).success?(t.$message.success(t.isEdit?"服务器更新成功":"服务器添加成功"),t.$emit("save",s.data)):t.$message.error(s.error||"保存失败"),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(9),t.$message.error("保存失败: "+e.t1.message);case 19:return e.prev=19,t.saving=!1,e.finish(19);case 22:case"end":return e.stop()}var a},e,t,[[0,5],[9,16,19,22]])}))()},handleDelete:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isEdit){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.$confirm("确定要删除这个服务器配置吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return");case 10:return t.deleting=!0,e.prev=11,e.next=14,a=t.formData.id,Object(h.a)({url:"/api/servers/"+a,method:"delete"});case 14:(s=e.sent).success?(t.$message.success("服务器删除成功"),t.$emit("delete",t.formData.id)):t.$message.error(s.error||"删除失败"),e.next=21;break;case 18:e.prev=18,e.t1=e.catch(11),t.$message.error("删除失败: "+e.t1.message);case 21:return e.prev=21,t.deleting=!1,e.finish(21);case 24:case"end":return e.stop()}var a},e,t,[[2,7],[11,18,21,24]])}))()},handleClose:function(){this.dialogVisible=!1}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{staticClass:"server-config-dialog",attrs:{title:t.isEdit?"编辑服务器":"添加服务器",visible:t.dialogVisible,width:"600px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-form",{ref:"serverForm",attrs:{model:t.formData,rules:t.formRules,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"服务器名称",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入服务器名称",maxlength:"50"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"主机地址",prop:"host"}},[s("el-input",{attrs:{placeholder:"IP地址或域名，如: 192.168.1.100"},model:{value:t.formData.host,callback:function(e){t.$set(t.formData,"host",e)},expression:"formData.host"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"SSH端口",prop:"port"}},[s("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:65535,placeholder:"SSH端口号"},model:{value:t.formData.port,callback:function(e){t.$set(t.formData,"port",e)},expression:"formData.port"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"认证方式",prop:"auth_type"}},[s("el-radio-group",{model:{value:t.formData.auth_type,callback:function(e){t.$set(t.formData,"auth_type",e)},expression:"formData.auth_type"}},[s("el-radio",{attrs:{label:"password"}},[t._v("密码认证")]),t._v(" "),s("el-radio",{attrs:{label:"key"}},[t._v("密钥认证")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{attrs:{placeholder:"SSH登录用户名"},model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}})],1),t._v(" "),"password"===t.formData.auth_type?s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"SSH登录密码","show-password":""},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1):t._e(),t._v(" "),"key"===t.formData.auth_type?s("el-form-item",{attrs:{label:"私钥文件",prop:"private_key_path"}},[s("el-input",{attrs:{placeholder:"私钥文件路径，如: ~/.ssh/id_rsa"},model:{value:t.formData.private_key_path,callback:function(e){t.$set(t.formData,"private_key_path",e)},expression:"formData.private_key_path"}})],1):t._e(),t._v(" "),"key"===t.formData.auth_type?s("el-form-item",{attrs:{label:"私钥密码",prop:"key_password"}},[s("el-input",{attrs:{type:"password",placeholder:"私钥密码（如果有）","show-password":""},model:{value:t.formData.key_password,callback:function(e){t.$set(t.formData,"key_password",e)},expression:"formData.key_password"}})],1):t._e(),t._v(" "),s("el-form-item",{attrs:{label:"监控间隔"}},[s("el-select",{staticStyle:{width:"100%"},model:{value:t.formData.monitor_interval,callback:function(e){t.$set(t.formData,"monitor_interval",e)},expression:"formData.monitor_interval"}},[s("el-option",{attrs:{label:"10秒",value:10}}),t._v(" "),s("el-option",{attrs:{label:"30秒",value:30}}),t._v(" "),s("el-option",{attrs:{label:"1分钟",value:60}}),t._v(" "),s("el-option",{attrs:{label:"5分钟",value:300}})],1),t._v(" "),s("div",{staticClass:"form-tip"},[t._v("数据采集间隔时间")])],1),t._v(" "),s("el-form-item",{attrs:{label:"描述"}},[s("el-input",{attrs:{type:"textarea",rows:3,placeholder:"服务器描述信息（可选）",maxlength:"200"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"启用监控"}},[s("el-switch",{model:{value:t.formData.enabled,callback:function(e){t.$set(t.formData,"enabled",e)},expression:"formData.enabled"}}),t._v(" "),s("div",{staticClass:"form-tip"},[t._v("是否启用对此服务器的监控")])],1)],1),t._v(" "),s("div",{staticClass:"test-connection"},[s("el-button",{attrs:{loading:t.testing,icon:"el-icon-connection"},on:{click:t.testConnection}},[t._v("\n      测试连接\n    ")]),t._v(" "),t.testResult?s("span",{class:t.testResult.success?"test-success":"test-error"},[t._v("\n      "+t._s(t.testResult.message)+"\n    ")]):t._e()],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),t.isEdit?s("el-button",{attrs:{type:"danger",loading:t.deleting},on:{click:t.handleDelete}},[t._v("\n      删除\n    ")]):t._e(),t._v(" "),s("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSave}},[t._v("\n      保存\n    ")])],1)],1)},staticRenderFns:[]};var _={name:"ServerMonitorDashboard",components:{ServerConfigDialog:s("VU/8")(d,f,!1,function(t){s("RGQ7")},"data-v-20a0d847",null).exports},data:function(){return{servers:[],selectedServer:null,currentServerInfo:{},connectionStatus:"disconnected",timeRange:"1h",autoRefresh:!0,loading:!1,showServerConfig:!1,editingServer:null,currentMetrics:{cpu:0,load_avg:0,memory_percent:0,memory_used:0,memory_total:0,disk_percent:0,disk_free:0,network_sent:0,network_recv:0},historicalData:{timestamps:[],cpu:[],memory:[],disk_read:[],disk_write:[],network_sent:[],network_recv:[]},topProcesses:[],charts:{cpu:null,memory:null,disk:null,network:null},refreshTimer:null}},mounted:function(){var t=this;this.loadServers(),this.$nextTick(function(){setTimeout(function(){console.log("🚀 开始初始化图表..."),t.initCharts(),setTimeout(function(){t.historicalData&&t.historicalData.timestamps&&t.historicalData.timestamps.length>0&&(console.log("🔄 延迟更新图表数据"),t.updateCharts())},500)},200)})},beforeDestroy:function(){this.stopAutoRefresh(),this.destroyCharts()},methods:{loadServers:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(h.a)({url:"/api/servers",method:"get"});case 3:s=e.sent,t.servers=s.data||[],0===t.servers.length&&t.$message.info("暂无配置的服务器，请先添加服务器配置"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.$message.error("加载服务器列表失败: "+e.t0.message);case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},onServerChange:function(){var t=this;return c()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectedServer){e.next=2;break}return e.abrupt("return");case 2:return t.currentServerInfo=t.servers.find(function(e){return e.id===t.selectedServer})||{},t.connectionStatus="connecting",e.next=6,t.testConnection();case 6:if("connected"!==t.connectionStatus){e.next=15;break}if(t.charts.cpu&&t.charts.memory&&t.charts.disk&&t.charts.network){e.next=12;break}return console.log("🔄 重新初始化图表..."),t.initCharts(),e.next=12,t.$nextTick();case 12:return e.next=14,t.loadServerData();case 14:t.autoRefresh&&t.startAutoRefresh();case 15:case"end":return e.stop()}},e,t)}))()},testConnection:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t.selectedServer);case 3:s=e.sent,t.connectionStatus=s.success?"connected":"disconnected",s.success||t.$message.error("服务器连接失败: "+s.error),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t.connectionStatus="disconnected",t.$message.error("连接测试失败: "+e.t0.message);case 12:case"end":return e.stop()}},e,t,[[0,8]])}))()},loadServerData:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectedServer){e.next=2;break}return e.abrupt("return");case 2:return t.loading=!0,e.prev=3,e.next=6,p(t.selectedServer,t.timeRange);case 6:(s=e.sent).success?(t.currentMetrics=s.data.current,t.historicalData=s.data.historical,t.topProcesses=s.data.processes||[],console.log("📊 获取到历史数据:",{timeRange:t.timeRange,timestamps:t.historicalData.timestamps?t.historicalData.timestamps.length:0,cpuData:t.historicalData.cpu?t.historicalData.cpu.length:0,firstTime:t.historicalData.timestamps?t.historicalData.timestamps[0]:null,lastTime:t.historicalData.timestamps?t.historicalData.timestamps[t.historicalData.timestamps.length-1]:null}),t.updateCharts(),"connected"!==t.connectionStatus&&(t.connectionStatus="connected")):(t.connectionStatus="disconnected",t.$message.error("获取服务器数据失败: "+s.error),s.suggestion&&t.$message.info(s.suggestion),t.currentMetrics={cpu:0,load_avg:0,memory_percent:0,memory_used:0,memory_total:0,disk_percent:0,disk_free:0,network_sent:0,network_recv:0},t.historicalData={timestamps:[],cpu:[],memory:[],disk_read:[],disk_write:[],network_sent:[],network_recv:[]},t.topProcesses=[]),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),t.connectionStatus="disconnected",t.$message.error("获取服务器数据失败: "+e.t0.message);case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}},e,t,[[3,10,14,17]])}))()},refreshData:function(){this.loadServerData()},onTimeRangeChange:function(){console.log("🕐 时间范围变化:",this.timeRange),this.loadServerData()},toggleAutoRefresh:function(){this.autoRefresh?this.startAutoRefresh():this.stopAutoRefresh()},startAutoRefresh:function(){var t=this;this.stopAutoRefresh(),this.refreshTimer=setInterval(function(){t.loadServerData()},3e4)},stopAutoRefresh:function(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null)},refreshProcesses:function(){this.loadServerData()},editCurrentServer:function(){this.editingServer=this.currentServerInfo,this.showServerConfig=!0},onServerSaved:function(t){this.loadServers(),this.showServerConfig=!1,t.id===this.selectedServer&&this.onServerChange()},onServerDeleted:function(t){this.loadServers(),this.showServerConfig=!1,t===this.selectedServer&&(this.selectedServer=null,this.connectionStatus="disconnected",this.stopAutoRefresh())},getCpuStatusClass:function(t){return t>=80?"status-critical":t>=60?"status-warning":"status-normal"},getMemoryStatusClass:function(t){return t>=85?"status-critical":t>=70?"status-warning":"status-normal"},getDiskStatusClass:function(t){return t>=90?"status-critical":t>=80?"status-warning":"status-normal"},formatBytes:function(t){if(0===t)return"0 B";var e=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,e)).toFixed(1))+" "+["B","KB","MB","GB"][e]},initCharts:function(){var t=this;this.$nextTick(function(){console.log("🎨 初始化图表..."),t.$refs.cpuChart?(t.charts.cpu=l.a(t.$refs.cpuChart,"dark"),console.log("✅ CPU图表初始化成功")):console.log("❌ CPU图表DOM元素未找到"),t.$refs.memoryChart?(t.charts.memory=l.a(t.$refs.memoryChart,"dark"),console.log("✅ 内存图表初始化成功")):console.log("❌ 内存图表DOM元素未找到"),t.$refs.diskChart?(t.charts.disk=l.a(t.$refs.diskChart,"dark"),console.log("✅ 磁盘图表初始化成功")):console.log("❌ 磁盘图表DOM元素未找到"),t.$refs.networkChart?(t.charts.network=l.a(t.$refs.networkChart,"dark"),console.log("✅ 网络图表初始化成功")):console.log("❌ 网络图表DOM元素未找到"),t.historicalData&&t.historicalData.timestamps&&t.historicalData.timestamps.length>0&&(console.log("🔄 图表初始化后立即更新数据"),t.updateCharts())})},updateCharts:function(){console.log("📈 更新图表，时间范围:",this.timeRange),console.log("📈 历史数据:",this.historicalData),this.updateCpuChart(),this.updateMemoryChart(),this.updateDiskChart(),this.updateNetworkChart()},updateCpuChart:function(){if(this.charts.cpu){console.log("📊 更新CPU图表，数据:",{timestamps:this.historicalData.timestamps?this.historicalData.timestamps.length:0,cpu:this.historicalData.cpu?this.historicalData.cpu.length:0,timestampsData:this.historicalData.timestamps,cpuData:this.historicalData.cpu});var t={tooltip:{trigger:"axis",formatter:"{b}<br/>CPU使用率: {c}%"},xAxis:{type:"category",data:this.historicalData.timestamps||[]},yAxis:{type:"value",min:0,max:100,axisLabel:{formatter:"{value}%"}},series:[{data:this.historicalData.cpu||[],type:"line",smooth:!0,itemStyle:{color:"#52c41a"},areaStyle:{opacity:.3}}]};this.charts.cpu.setOption(t),console.log("✅ CPU图表更新完成")}else console.log("❌ CPU图表未初始化")},updateMemoryChart:function(){if(this.charts.memory){console.log("📊 更新内存图表，数据:",{timestamps:this.historicalData.timestamps?this.historicalData.timestamps.length:0,memory:this.historicalData.memory?this.historicalData.memory.length:0});var t={tooltip:{trigger:"axis",formatter:"{b}<br/>内存使用率: {c}%"},xAxis:{type:"category",data:this.historicalData.timestamps},yAxis:{type:"value",min:0,max:100,axisLabel:{formatter:"{value}%"}},series:[{data:this.historicalData.memory,type:"line",smooth:!0,itemStyle:{color:"#1890ff"},areaStyle:{opacity:.3}}]};this.charts.memory.setOption(t)}else console.log("❌ 内存图表未初始化")},updateDiskChart:function(){var t=this;if(this.charts.disk){console.log("📊 更新磁盘图表，数据:",{timestamps:this.historicalData.timestamps?this.historicalData.timestamps.length:0,diskRead:this.historicalData.diskRead?this.historicalData.diskRead.length:0,diskWrite:this.historicalData.diskWrite?this.historicalData.diskWrite.length:0});var e={tooltip:{trigger:"axis"},legend:{data:["读取","写入"]},grid:{left:"80px",right:"20px",top:"60px",bottom:"60px"},xAxis:{type:"category",data:this.historicalData.timestamps},yAxis:{type:"value",axisLabel:{formatter:function(e){return t.formatBytes(e)+"/s"}}},series:[{name:"读取",data:this.historicalData.diskRead||this.historicalData.disk_read||[],type:"line",smooth:!0,itemStyle:{color:"#faad14"}},{name:"写入",data:this.historicalData.diskWrite||this.historicalData.disk_write||[],type:"line",smooth:!0,itemStyle:{color:"#f5222d"}}]};this.charts.disk.setOption(e)}else console.log("❌ 磁盘图表未初始化")},updateNetworkChart:function(){var t=this;if(this.charts.network){console.log("📊 更新网络图表，数据:",{timestamps:this.historicalData.timestamps?this.historicalData.timestamps.length:0,networkIn:this.historicalData.networkIn?this.historicalData.networkIn.length:0,networkOut:this.historicalData.networkOut?this.historicalData.networkOut.length:0});var e={tooltip:{trigger:"axis"},legend:{data:["发送","接收"]},grid:{left:"80px",right:"20px",top:"60px",bottom:"60px"},xAxis:{type:"category",data:this.historicalData.timestamps},yAxis:{type:"value",axisLabel:{formatter:function(e){return t.formatBytes(e)+"/s"}}},series:[{name:"发送",data:this.historicalData.networkOut||this.historicalData.network_sent||[],type:"line",smooth:!0,itemStyle:{color:"#722ed1"}},{name:"接收",data:this.historicalData.networkIn||this.historicalData.network_recv||[],type:"line",smooth:!0,itemStyle:{color:"#13c2c2"}}]};this.charts.network.setOption(e)}else console.log("❌ 网络图表未初始化")},toggleChartFullscreen:function(t){this.$message.info("全屏功能开发中...")},destroyCharts:function(){r()(this.charts).forEach(function(t){t&&t.dispose()})},forceResizeCharts:function(){var t=this;console.log("🔄 强制重新渲染图表..."),this.$nextTick(function(){r()(t.charts).forEach(function(t){t&&t.resize()})})},reinitCharts:function(){var t=this;console.log("🔄 重新初始化图表..."),this.destroyCharts(),this.charts={cpu:null,memory:null,disk:null,network:null},setTimeout(function(){t.initCharts()},100)},generateTestData:function(){console.log("🎲 生成测试数据...");var t=new Date,e=[],s=[],a=[],r=[],i=[],n=[],o=[],c=30,l=1;switch(this.timeRange){case"5m":c=30,l=.2;break;case"15m":c=30,l=.5;break;case"1h":c=30,l=2;break;case"6h":c=30,l=12;break;case"24h":c=30,l=48}for(var u=0;u<c;u++){var m=new Date(t.getTime()-(c-u)*l*60*1e3);e.push(m.toLocaleTimeString()),s.push(Math.max(0,Math.min(100,30+20*Math.sin(.3*u)+10*Math.random()))),a.push(Math.max(0,Math.min(100,40+15*Math.sin(.2*u)+8*Math.random()))),r.push(Math.max(0,50+30*Math.sin(.4*u)+20*Math.random())),i.push(Math.max(0,30+20*Math.sin(.5*u)+15*Math.random())),n.push(Math.max(0,100+50*Math.sin(.3*u)+30*Math.random())),o.push(Math.max(0,80+40*Math.sin(.4*u)+25*Math.random()))}this.historicalData={timestamps:e,cpu:s,memory:a,diskRead:r,diskWrite:i,networkIn:n,networkOut:o},console.log("✅ 测试数据生成完成:",this.historicalData),this.updateCharts(),this.$message.success("测试数据生成成功！")}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"server-monitor"},[s("div",{staticClass:"monitor-header"},[s("div",{staticClass:"server-selector"},[s("el-select",{attrs:{placeholder:"选择服务器"},on:{change:t.onServerChange},model:{value:t.selectedServer,callback:function(e){t.selectedServer=e},expression:"selectedServer"}},t._l(t.servers,function(t){return s("el-option",{key:t.id,attrs:{label:t.name+" ("+t.host+")",value:t.id}})}),1),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showServerConfig=!0}}},[t._v("配置服务器")])],1),t._v(" "),s("div",{staticClass:"time-controls"},[s("el-select",{on:{change:t.onTimeRangeChange},model:{value:t.timeRange,callback:function(e){t.timeRange=e},expression:"timeRange"}},[s("el-option",{attrs:{label:"最近5分钟",value:"5m"}}),t._v(" "),s("el-option",{attrs:{label:"最近15分钟",value:"15m"}}),t._v(" "),s("el-option",{attrs:{label:"最近1小时",value:"1h"}}),t._v(" "),s("el-option",{attrs:{label:"最近6小时",value:"6h"}}),t._v(" "),s("el-option",{attrs:{label:"最近24小时",value:"24h"}})],1),t._v(" "),s("el-button",{attrs:{loading:t.loading},on:{click:t.refreshData}},[s("i",{staticClass:"el-icon-refresh"}),t._v(" 刷新\n      ")]),t._v(" "),s("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.reinitCharts}},[s("i",{staticClass:"el-icon-refresh-right"}),t._v(" 重新初始化图表\n      ")]),t._v(" "),s("el-button",{attrs:{type:"success",size:"small"},on:{click:t.generateTestData}},[s("i",{staticClass:"el-icon-data-line"}),t._v(" 生成测试数据\n      ")]),t._v(" "),s("el-switch",{attrs:{"active-text":"自动刷新"},on:{change:t.toggleAutoRefresh},model:{value:t.autoRefresh,callback:function(e){t.autoRefresh=e},expression:"autoRefresh"}})],1)]),t._v(" "),t.selectedServer?s("div",{staticClass:"server-overview"},[s("div",{staticClass:"server-info"},[s("h2",[t._v(t._s(t.currentServerInfo.name))]),t._v(" "),s("div",{staticClass:"server-details"},[s("span",[t._v(t._s(t.currentServerInfo.host)+":"+t._s(t.currentServerInfo.port))]),t._v(" "),s("el-tag",{attrs:{type:"connected"===t.connectionStatus?"success":"danger",size:"small"}},[t._v("\n          "+t._s("connected"===t.connectionStatus?"已连接":"连接失败")+"\n        ")])],1)])]):t._e(),t._v(" "),t.selectedServer&&"connected"===t.connectionStatus?s("div",{staticClass:"metrics-cards"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:6}},[s("div",{staticClass:"metric-card cpu"},[s("div",{staticClass:"metric-icon"},[s("i",{staticClass:"el-icon-cpu"})]),t._v(" "),s("div",{staticClass:"metric-content"},[s("div",{staticClass:"metric-value",class:t.getCpuStatusClass(t.currentMetrics.cpu)},[t._v("\n              "+t._s(t.currentMetrics.cpu)+"%\n            ")]),t._v(" "),s("div",{staticClass:"metric-label"},[t._v("CPU使用率")]),t._v(" "),s("div",{staticClass:"metric-detail"},[t._v("\n              负载: "+t._s(t.currentMetrics.load_avg)+"\n            ")])])])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"metric-card memory"},[s("div",{staticClass:"metric-icon"},[s("i",{staticClass:"el-icon-memory-card"})]),t._v(" "),s("div",{staticClass:"metric-content"},[s("div",{staticClass:"metric-value",class:t.getMemoryStatusClass(t.currentMetrics.memory_percent)},[t._v("\n              "+t._s(t.currentMetrics.memory_percent)+"%\n            ")]),t._v(" "),s("div",{staticClass:"metric-label"},[t._v("内存使用率")]),t._v(" "),s("div",{staticClass:"metric-detail"},[t._v("\n              "+t._s(t.currentMetrics.memory_used)+"GB / "+t._s(t.currentMetrics.memory_total)+"GB\n            ")])])])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"metric-card disk"},[s("div",{staticClass:"metric-icon"},[s("i",{staticClass:"el-icon-folder"})]),t._v(" "),s("div",{staticClass:"metric-content"},[s("div",{staticClass:"metric-value",class:t.getDiskStatusClass(t.currentMetrics.disk_percent)},[t._v("\n              "+t._s(t.currentMetrics.disk_percent)+"%\n            ")]),t._v(" "),s("div",{staticClass:"metric-label"},[t._v("磁盘使用率")]),t._v(" "),s("div",{staticClass:"metric-detail"},[t._v("\n              剩余: "+t._s(t.currentMetrics.disk_free)+"GB\n            ")])])])]),t._v(" "),s("el-col",{attrs:{span:6}},[s("div",{staticClass:"metric-card network"},[s("div",{staticClass:"metric-icon"},[s("i",{staticClass:"el-icon-connection"})]),t._v(" "),s("div",{staticClass:"metric-content"},[s("div",{staticClass:"metric-value"},[t._v("\n              "+t._s(t.formatBytes(t.currentMetrics.network_sent))+"/s\n            ")]),t._v(" "),s("div",{staticClass:"metric-label"},[t._v("网络发送")]),t._v(" "),s("div",{staticClass:"metric-detail"},[t._v("\n              接收: "+t._s(t.formatBytes(t.currentMetrics.network_recv))+"/s\n            ")])])])])],1)],1):t._e(),t._v(" "),t.selectedServer&&"connected"===t.connectionStatus?s("div",{staticClass:"charts-section"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("div",{staticClass:"chart-panel"},[s("div",{staticClass:"panel-header"},[s("h3",[t._v("CPU使用率趋势")]),t._v(" "),s("div",{staticClass:"panel-controls"},[s("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.toggleChartFullscreen("cpu")}}},[s("i",{staticClass:"el-icon-full-screen"})])],1)]),t._v(" "),s("div",{ref:"cpuChart",staticClass:"chart-container"})])]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",{staticClass:"chart-panel"},[s("div",{staticClass:"panel-header"},[s("h3",[t._v("内存使用趋势")]),t._v(" "),s("div",{staticClass:"panel-controls"},[s("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.toggleChartFullscreen("memory")}}},[s("i",{staticClass:"el-icon-full-screen"})])],1)]),t._v(" "),s("div",{ref:"memoryChart",staticClass:"chart-container"})])])],1),t._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("div",{staticClass:"chart-panel"},[s("div",{staticClass:"panel-header"},[s("h3",[t._v("磁盘I/O")]),t._v(" "),s("div",{staticClass:"panel-controls"},[s("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.toggleChartFullscreen("disk")}}},[s("i",{staticClass:"el-icon-full-screen"})])],1)]),t._v(" "),s("div",{ref:"diskChart",staticClass:"chart-container"})])]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",{staticClass:"chart-panel"},[s("div",{staticClass:"panel-header"},[s("h3",[t._v("网络流量")]),t._v(" "),s("div",{staticClass:"panel-controls"},[s("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.toggleChartFullscreen("network")}}},[s("i",{staticClass:"el-icon-full-screen"})])],1)]),t._v(" "),s("div",{ref:"networkChart",staticClass:"chart-container"})])])],1)],1):t._e(),t._v(" "),t.selectedServer&&"connected"===t.connectionStatus?s("div",{staticClass:"process-section"},[s("div",{staticClass:"section-header"},[s("h3",[t._v("进程监控")]),t._v(" "),s("el-button",{attrs:{size:"mini"},on:{click:t.refreshProcesses}},[t._v("刷新进程")])],1),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.topProcesses}},[s("el-table-column",{attrs:{prop:"pid",label:"PID",width:"80"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"进程名",width:"200"}}),t._v(" "),s("el-table-column",{attrs:{prop:"cpu_percent",label:"CPU%",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{class:t.getCpuStatusClass(e.row.cpu_percent)},[t._v("\n            "+t._s(e.row.cpu_percent)+"%\n          ")])]}}],null,!1,4156195574)}),t._v(" "),s("el-table-column",{attrs:{prop:"memory_percent",label:"内存%",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{class:t.getMemoryStatusClass(e.row.memory_percent)},[t._v("\n            "+t._s(e.row.memory_percent)+"%\n          ")])]}}],null,!1,120968529)}),t._v(" "),s("el-table-column",{attrs:{prop:"memory_mb",label:"内存(MB)",width:"120"}}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"create_time",label:"启动时间"}})],1)],1):t._e(),t._v(" "),t.selectedServer?t._e():s("div",{staticClass:"no-server-selected"},[s("div",{staticClass:"empty-state"},[s("i",{staticClass:"el-icon-monitor"}),t._v(" "),s("h3",[t._v("欢迎使用服务器监控系统")]),t._v(" "),s("p",[t._v("请先配置要监控的服务器")]),t._v(" "),t._m(0),t._v(" "),s("el-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.showServerConfig=!0}}},[s("i",{staticClass:"el-icon-plus"}),t._v(" 配置第一台服务器\n      ")])],1)]),t._v(" "),t.selectedServer&&"disconnected"===t.connectionStatus?s("div",{staticClass:"connection-failed"},[s("div",{staticClass:"error-state"},[s("i",{staticClass:"el-icon-warning"}),t._v(" "),s("h3",[t._v("无法连接到服务器")]),t._v(" "),s("p",[t._v(t._s(t.currentServerInfo.name)+" ("+t._s(t.currentServerInfo.host)+")")]),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"error-actions"},[s("el-button",{attrs:{loading:t.loading},on:{click:t.testConnection}},[s("i",{staticClass:"el-icon-refresh"}),t._v(" 重新连接\n        ")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.editCurrentServer}},[s("i",{staticClass:"el-icon-edit"}),t._v(" 编辑配置\n        ")]),t._v(" "),s("el-button",{on:{click:t.loadServerData}},[s("i",{staticClass:"el-icon-connection"}),t._v(" 获取数据\n        ")])],1)])]):t._e(),t._v(" "),s("server-config-dialog",{attrs:{visible:t.showServerConfig,server:t.editingServer},on:{"update:visible":function(e){t.showServerConfig=e},save:t.onServerSaved,delete:t.onServerDeleted}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"setup-steps"},[s("div",{staticClass:"step"},[s("span",{staticClass:"step-number"},[t._v("1")]),t._v(" "),s("span",{staticClass:"step-text"},[t._v('点击"配置服务器"按钮')])]),t._v(" "),s("div",{staticClass:"step"},[s("span",{staticClass:"step-number"},[t._v("2")]),t._v(" "),s("span",{staticClass:"step-text"},[t._v("填写服务器连接信息")])]),t._v(" "),s("div",{staticClass:"step"},[s("span",{staticClass:"step-number"},[t._v("3")]),t._v(" "),s("span",{staticClass:"step-text"},[t._v("测试连接并保存配置")])]),t._v(" "),s("div",{staticClass:"step"},[s("span",{staticClass:"step-number"},[t._v("4")]),t._v(" "),s("span",{staticClass:"step-text"},[t._v("选择服务器开始监控")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"error-details"},[s("p",[t._v("可能的原因：")]),t._v(" "),s("ul",[s("li",[t._v("服务器未启动或网络不通")]),t._v(" "),s("li",[t._v("SSH服务未运行或端口被阻拦")]),t._v(" "),s("li",[t._v("用户名或密码错误")]),t._v(" "),s("li",[t._v("防火墙阻止连接")])])])}]};var C=s("VU/8")(_,g,!1,function(t){s("qmhh")},"data-v-2dd160e7",null);e.default=C.exports},qmhh:function(t,e){}});
//# sourceMappingURL=8.d70b33a3db5947765c54.js.map